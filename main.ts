namespace SpriteKind {
    export const Bullet = SpriteKind.create()
    export const BulletB = SpriteKind.create()
}
sprites.onOverlap(SpriteKind.Enemy, SpriteKind.Bullet, function (sprite, otherSprite) {
    sprite.destroy()
    otherSprite.destroy()
    info.changeScoreBy(10)
    music.pewPew.play()
})
sprites.onOverlap(SpriteKind.Enemy, SpriteKind.BulletB, function (sprite, otherSprite) {
    sprite.destroy(effects.fire, 200)
    info.changeScoreBy(20)
    music.pewPew.play()
})
controller.B.onEvent(ControllerButtonEvent.Pressed, function () {
    controller.moveSprite(mySprite, 100, 100)
})
controller.B.onEvent(ControllerButtonEvent.Released, function () {
    if (ShootPower >= 80) {
        projectile = sprites.createProjectileFromSprite(img`
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . 4 
            . . . . . . . . . . . . 4 4 4 4 
            . . . . . . . . . . . 4 4 5 5 4 
            . . . . . . . . . 4 4 4 5 5 5 4 
            . . . . . . . 4 4 4 5 5 5 5 5 5 
            . . 4 4 4 4 4 4 5 5 5 5 5 5 2 5 
            . . . . . . . 4 4 4 5 5 5 5 5 5 
            . . . . . . . . . 4 4 4 5 5 5 4 
            . . . . . . . . . . . 4 4 5 5 4 
            . . . . . . . . . . . . 4 4 4 4 
            . . . . . . . . . . . . . . . 4 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            `, mySprite, 80, 0)
        projectile.setKind(SpriteKind.BulletB)
        music.beamUp.play()
    }
    animation.stopAnimation(animation.AnimationTypes.All, mySprite)
    mySprite.setImage(img`
        . . . . . . . . . . . . . . . . 
        . . . . . . 2 2 2 2 2 e . . . . 
        . . . . . 2 2 2 2 d 2 2 e . . . 
        . . . . e 2 2 2 2 2 2 2 e . . . 
        . . . . e 2 2 2 2 2 2 2 e . . . 
        . . . . e 2 2 2 2 2 e f f c c . 
        . . . . e e 2 2 e f f f f b c . 
        . . e e e f e 2 2 b f f f d c . 
        . e e 2 2 d f e 2 1 1 1 1 b c . 
        . e e 2 2 d f e e e c c c . . . 
        . b 1 1 e e 2 2 e e c . . . . . 
        . . f d d 2 2 2 f f f d d . . . 
        e e f d d e e e . f f d d . . . 
        e e e f f f f f . . . . . . . . 
        e e . . . . f f f . . . . . . . 
        . . . . . . f f f f . . . . . . 
        `)
    ChangeAnimFlag = 0
    ShootPower = 0
})
controller.A.onEvent(ControllerButtonEvent.Pressed, function () {
    projectile = sprites.createProjectileFromSprite(img`
        ....................
        ....................
        ....................
        ....................
        ....................
        ....................
        ..............666991
        ....................
        ..............666991
        ....................
        ....................
        ....................
        ....................
        ....................
        ....................
        ....................
        `, mySprite, 100, 0)
    projectile.setKind(SpriteKind.Bullet)
    pause(250)
})
let Enemy2: Sprite = null
let Enemy1: Sprite = null
let Enemy3: Sprite = null
let Enemy3Available = 0
let Timer = 0
let projectile: Sprite = null
let ShootPower = 0
let ChangeAnimFlag = 0
let mySprite: Sprite = null
mySprite = sprites.create(img`
    ..............................
    ..............................
    ..............ffffff..........
    .f88.........f6668ff..........
    .f998.....fff6668ff...........
    .f999888881111111188..........
    .f1199888111112221198.........
    .f111911111111112299988.......
    f61111111111116666691118......
    ffffff8666811111111111f.......
    ....ff66669981111111ff........
    ...8f666699fffffffff..........
    ...8666699f...................
    ...866668f....................
    ...ffffff.....................
    ..............................
    `, SpriteKind.Player)
controller.moveSprite(mySprite, 80, 80)
mySprite.setFlag(SpriteFlag.StayInScreen, true)
mySprite.setPosition(6, 60)
let statusbar = statusbars.create(20, 3, StatusBarKind.Energy)
statusbar.attachToSprite(mySprite)
statusbar.value = 80
statusbar.setColor(5, 12)
ChangeAnimFlag = 0
game.onUpdate(function () {
    Timer += 0.1
    console.logValue("Timer", Timer)
    console.logValue("Position", Math.sin(Timer))
    if (Enemy3Available == 1) {
        Enemy3.y += Math.sin(Timer) * randint(1, 4)
    }
})
game.onUpdateInterval(2000, function () {
    if (Math.percentChance(20)) {
        Enemy3 = sprites.create(img`
            ....ffffff.........ccc..
            ....ff88ccf.......ccaf..
            .....ffccccfff...ccaaf..
            ....cc8aaa8888ccccaa8f..
            ...c9baa88888888cca88f..
            ..c999b8888888888888fc..
            .c8b99111b888888888c88c.
            c888b111998888ccccccc88f
            f888888888888c888ccfffff
            .f8888888888aa8888f.....
            ..ff8888888cfaa8888f....
            ....ffffffffffaa8888c...
            .........f8cfffc8888c...
            .........fcc8ffffffff...
            ..........fc8ffff.......
            ...........fffff........
            `, SpriteKind.Enemy)
        Enemy3.setPosition(160, randint(40, 80))
        Enemy3.vx = -20
        Enemy3Available = 1
    }
})
forever(function () {
    console.log(ShootPower)
    statusbar.value = ShootPower
    if (controller.B.isPressed()) {
        animation.runImageAnimation(
        mySprite,
        [img`
            ................................
            ................................
            ..............ffffff............
            .f88.........f6668ff............
            .f998.....fff6668ff.............
            .f999888881111111188............
            .f1199888111112221198.....6.....
            .f111911111111112299988..696....
            f6111111111111666669111869196...
            ffffff8666811111111111f..696....
            ....ff66669981111111ff....6.....
            ...8f666699fffffffff............
            ...8666699f.....................
            ...866668f......................
            ...ffffff.......................
            ................................
            `,img`
            ................................
            ................................
            ..............ffffff............
            .f88.........f6668ff......6.....
            .f998.....fff6668ff...6.......6.
            .f999888881111111188............
            .f1199888111112221198.....6.....
            .f111911111111112299988..696....
            f6111111111111666669111869196..6
            ffffff8666811111111111f..696....
            ....ff66669981111111ff....6.....
            ...8f666699fffffffff............
            ...8666699f...........6.......6.
            ...866668f................6.....
            ...ffffff.......................
            ................................
            `,img`
            ................................
            ................................
            ..............ffffff............
            .f88.........f6668ff......6.....
            .f998.....fff6668ff...6...6...6.
            .f999888881111111188...6.....6..
            .f1199888111112221198.....6.....
            .f111911111111112299988..696....
            f6111111111111666669111869196.66
            ffffff8666811111111111f..696....
            ....ff66669981111111ff....6.....
            ...8f666699fffffffff...6.....6..
            ...8666699f...........6...6...6.
            ...866668f................6.....
            ...ffffff.......................
            ................................
            `,img`
            ................................
            ................................
            ..............ffffff............
            .f88.........f6668ff............
            .f998.....fff6668ff.......6.....
            .f999888881111111188...6..6..6..
            .f1199888111112221198...6.6.6...
            .f111911111111112299988..696....
            f611111111111166666911186919666.
            ffffff8666811111111111f..696....
            ....ff66669981111111ff..6.6.6...
            ...8f666699fffffffff...6..6..6..
            ...8666699f...............6.....
            ...866668f......................
            ...ffffff.......................
            ................................
            `,img`
            ................................
            ................................
            ..............ffffff............
            .f88.........f6668ff............
            .f998.....fff6668ff.............
            .f999888881111111188......6.....
            .f1199888111112221198...6.6.6...
            .f111911111111112299988..696....
            f61111111111116666691118691966..
            ffffff8666811111111111f..696....
            ....ff66669981111111ff..6.6.6...
            ...8f666699fffffffff......6.....
            ...8666699f.....................
            ...866668f......................
            ...ffffff.......................
            ................................
            `],
        100,
        true
        )
        ShootPower += 1
    } else {
        animation.stopAnimation(animation.AnimationTypes.ImageAnimation, mySprite)
    }
})
forever(function () {
	
})
game.onUpdateInterval(500, function () {
    if (Math.percentChance(70)) {
        Enemy1 = sprites.create(img`
            . . . . . . . . . . . . . . . . 
            . . . . . . . . c c c c . . . . 
            . . . . . . c c a a a a c . . . 
            . . . . . c c c c c c a c . . . 
            . . . . c c 8 8 8 8 a c c . . . 
            . . . c 8 a 8 8 8 8 8 a c . c c 
            . . c 8 8 8 a 8 8 8 8 a a c 8 c 
            . c 8 8 8 8 a 8 8 8 8 8 a c 8 c 
            c 8 8 8 8 8 a 8 8 8 8 8 a 8 8 c 
            c 8 8 8 5 8 a c c 8 8 8 a c 8 c 
            c 8 8 8 8 8 a 8 8 c 8 8 a c 8 c 
            . c 8 8 8 8 a c 8 c 8 a c c c c 
            . . c c 8 a 8 8 c c 8 c c c . . 
            . . . . c c 8 8 8 8 c a c c . . 
            . . . . . . c c c c a a a c . . 
            . . . . . . . . . . c c c . . . 
            `, SpriteKind.Enemy)
        Enemy1.setPosition(160, randint(5, 115))
        Enemy1.setVelocity(randint(-20, -40), 0)
    } else {
        Enemy2 = sprites.create(img`
            .............ccfff..............
            ...........ccdd5cf..............
            ..........ccdd55f...............
            ..........fcc55cf...............
            .....fffffccccccff.........ccc..
            ...ff5555555c5555cfff....cc55c..
            ..f55555555cbc5555cccff.c555c...
            ff555555aa55c5c555cccccfc555f...
            f5c555bbaab5c55555cccccff55f....
            f555bbbbbbbb55555ccccccc55cf....
            .f5bbb33ccbb5555cccccccccccf....
            ..fccc3bcbbb555ccccc555ff55cf...
            ...fcb3cbbbc555fc5555cc..f55f...
            ....fcccbbbf5d55cc5cc.....f55f..
            ........ccccfcd55cc........fff..
            .............fffff..............
            `, SpriteKind.Enemy)
        Enemy2.setPosition(160, randint(5, 115))
        Enemy2.setVelocity(randint(-20, -40), randint(-20, 20))
    }
})
